---
- name: Install dependencies (Debian/Ubuntu)
  ansible.builtin.package:
    name:
      - rsync
      - wget
      - build-essential
    state: latest
  register: package_install_res
  retries: 5
  until: package_install_res is success
  when: ansible_distribution in ["Debian", "Ubuntu"]

- name: Install dependencies (SUSE)
  ansible.builtin.package:
    name:
      - autoconf
      - bison
      - flex
      - gcc
      - gcc-c++
      - kernel-default-devel
      - make
      - m4
      - rsync
      - wget
    state: latest
  register: package_install_res
  retries: 5
  until: package_install_res is success
  when: ansible_distribution == "SUSE"

- name: Install dependencies (CentOS)
  ansible.builtin.package:
    name:
      - autoconf
      - bison
      - flex
      - gcc
      - gcc-c++
      - kernel-devel
      - make
      - m4
      - patch
      - rsync
      - wget
    state: latest
  register: package_install_res
  retries: 5
  until: package_install_res is success
  when: ansible_distribution in ["Fedora", "RedHat", "CentOS"]
